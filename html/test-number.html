<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <meta charset="UTF-8">
    <title>交易页面</title>
    <link rel="stylesheet" href="../asset/css/bootstrap.css">
    <script src="../asset/js/jquery-2.2.0.min.js"></script>
    <script src="../asset/js/bootstrap.js"></script>
</head>
<body>
<div class="container">
    <div class="panel panel-default">
        <div class="panel-heading" style="min-height: 35px;">
            <h3 class="panel-title">翻打凭条模拟</h3>
        </div>
        <div class="panel-body">
            <div class="row" style="padding-left: 15px; padding-right: 15px;">
                <button class="btn btn-danger pull-left">点击开始</button>
                <button class="btn btn-primary" id="commitOpr">提交凭条</button>
                <div class="form-inline pull-right">
                    <div class="input-group">
                        <div class="input-group-addon">剩余时间：</div>
                        <input id="num-used" type="text" class="timer form-control" readonly
                               style="width: 120px; color: #2b59ff;" value="5m">

                    </div>
                </div>


            </div>
            <div class="row">
                <div class="pull-left" style="margin-left:15px; margin-top: 50px; width: 200px;">

                    <div class="num" style="font-size: 30px; line-height: 50px; height: 50px; text-align: right; background-color: dodgerblue;">
                        3,789,123.89
                    </div>
                    <div style="margin-top: 20px;">
                        <input class="form-control" type="text" placeholder="录入上面的数字">

                    </div>

                </div>
                <div class="pull-right col-md-4" style="margin-top: 15px;">
                    <div style="height: 300px; overflow-y: scroll; border: 1px solid lightgray;">
                        <table class="table table-bordered">
                            <thead>
                            <tr>
                                <th>金额</th>
                                <th>我的输入</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td>21,123,122.22</td>
                                <td>21,123,122.22</td>
                            </tr>
                            <tr>
                                <td>21,123,122.22</td>
                                <td>21,123,122.22</td>
                            </tr>
                            <tr>
                                <td>21,123,122.22</td>
                                <td>21,123,122.22</td>
                            </tr><tr>
                                <td>21,123,122.22</td>
                                <td>21,123,122.22</td>
                            </tr><tr>
                                <td>21,123,122.22</td>
                                <td>21,123,122.22</td>
                            </tr><tr>
                                <td>21,123,122.22</td>
                                <td>21,123,122.22</td>
                            </tr><tr>
                                <td>21,123,122.22</td>
                                <td>21,123,122.22</td>
                            </tr>




                            </tbody>
                        </table>
                    </div>

                </div>
            </div>
        </div>
    </div>

</div>

<script>
    $(function () {
        $("#number").on("keyup", function () {
            var val = $(this).val();
            console.log("val: ", val);
            if (val.indexOf(",") > -1) {
                val = val.replace(new RegExp(/(,)/g), "");
            }
            var reg = val.match(/\d+\.?\d{0,2}/);
            var txt = '';
            if (reg != null) {
                txt = reg[0];
            }
            console.log("txt: ", txt);
            $(this).val(fmoney(txt));
        })

//        $("#number").on("blur", function () {
//            var val = $(this).val();
//            if(val.indexOf(",") > -1){
//                val = val.replace(new RegExp(/(,)/g), "");
//            }
//            var reg = val.match(/\d+\.?\d{0,2}/);
//            var txt = '';
//            if (reg != null) {
//                txt = reg[0];
//            }
//            $(this).val(fmoney(txt));
//        }).on("focus", function () {
//            var val = $(this).val();
//            if(val.indexOf(",") > -1){
//                val = val.replace(new RegExp(/(,)/g), "");
//            }
//            $(this).val(val).select();
//        });
//        .on("input propertychange", (function () {
//            $(this).keyup();
    });
    function fmoney(s, n) {
        n = n > 0 && n <= 20 ? n : 2;
        s = parseFloat((s + "").replace(/[^\d\.-]/g, "")).toFixed(n) + "";
        var l = s.split(".")[0].split("").reverse(),
            r = s.split(".")[1];
        t = "";
        for (i = 0; i < l.length; i++) {
            t += l[i] + ((i + 1) % 3 == 0 && (i + 1) != l.length ? "," : "");
        }
        return t.split("").reverse().join("") + "." + r;
    }
</script>
</body>
</html>